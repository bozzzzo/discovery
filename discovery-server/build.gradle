apply plugin: 'application'

ext {
  argparse4jVersion = '0.6.0'
  assertjVersion = '3.2.0'
  awaitilityVersion = '1.7.0'
  hazelcastVersion = '3.6'
  jacksonVersion = '2.7.1'
  jacksonKotlinVersion = "${jacksonVersion}-2"
  junitVersion = '4.12'
  kotlinVersion = '1.0.0'
  logbackVersion = '1.1.3'
  metricsCloudwatch = '0.4.0'
  slf4jVersion = '1.7.14'
  vertxVersion = '3.2.1'
}

repositories {
  mavenCentral()
  maven {
    url "https://oss.sonatype.org/content/repositories/snapshots"
  }
}

configurations {
  all*.exclude group: 'com.hazelcast:hazelcast'
}

tasks.withType(Tar){
  compression = Compression.GZIP
}

dependencies {
  compile(
      "ch.qos.logback:logback-classic:${logbackVersion}",

      "com.blacklocus:metrics-cloudwatch:${metricsCloudwatch}",

      "com.hazelcast:hazelcast:${hazelcastVersion}",
      "com.hazelcast:hazelcast-cloud:${hazelcastVersion}",

      "com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:${jacksonVersion}",
      "com.fasterxml.jackson.module:jackson-module-kotlin:${jacksonKotlinVersion}",

      "io.datawire.commons:datawire-config:0.0.3-SNAPSHOT",
      "io.datawire.commons:datawire-application:0.0.3-SNAPSHOT",

      "io.vertx:vertx-auth-jwt:${vertxVersion}",
      "io.vertx:vertx-core:${vertxVersion}",
      "io.vertx:vertx-dropwizard-metrics:${vertxVersion}",
      "io.vertx:vertx-hazelcast:${vertxVersion}",
      "io.vertx:vertx-web:${vertxVersion}",

      "net.sourceforge.argparse4j:argparse4j:${argparse4jVersion}",

      "org.jetbrains.kotlin:kotlin-stdlib:${kotlinVersion}",
      "org.jetbrains.kotlin:kotlin-reflect:${kotlinVersion}",

      "org.slf4j:slf4j-api:${slf4jVersion}",

      project(":discovery-common")
  )

  testCompile(
      "org.assertj:assertj-core:${assertjVersion}",
      "junit:junit:${junitVersion}",
      "io.vertx:vertx-unit:${vertxVersion}",
      "com.jayway.awaitility:awaitility:${awaitilityVersion}"
  )
}

mainClassName = 'io.datawire.discovery.DiscoveryService'

applicationDistribution.from(parent.projectDir) {
  include 'LICENSE'
  include 'NOTICE'
  include 'README.md'
  into ''
}